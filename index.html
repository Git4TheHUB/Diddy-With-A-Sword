<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Void Boss Popup Auto</title>

<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

<style>
html, body {
    background:#000;
    margin:0;
    height:100vh;
    overflow:hidden;
    display:flex;
    align-items:center;
    justify-content:center;
    font-family:'Press Start 2P', monospace;
}

.popup {
    width:80vmin;
    height:80vmin;
    background:#000;
    color:white;
    overflow:hidden;
    font-size:10px;
    display:flex;
    flex-direction:column;
}

.header {
    background:#000;
    padding:10px;
    text-align:center;
    letter-spacing:1px;
}

.content {
    padding:12px;
    flex:1;
    display:flex;
    flex-direction:column;
}

/* FORCE MEDIA TO FIT */
.media {
    flex:1;
    display:flex;
    align-items:center;
    justify-content:center;
    max-height:55%;
}

.media img, .media video {
    max-width:90%;
    max-height:90%;
    object-fit:contain;
}

/* UNDERTALE BOX */
.speech {
    margin-top:10px;
    background:#000;
    border:4px solid #fff;
    padding:14px;
    min-height:90px;
    line-height:1.6em;
}
</style>
</head>

<body>

<script>

const slots = [
  { type:"png", url:"https://www.freeiconspng.com/uploads/download-google-chrome-icon--15.png", text:"Howdy! I'm CHROME!" },
  { type:"png", url:"https://www.freeiconspng.com/uploads/download-google-chrome-icon--15.png", text:"CHROME the CHROMER!" },
  { type:"png", url:"https://cdn.freebiesupply.com/logos/large/2x/google-chrome-logo-png-transparent.png", text:"Hmmm... You're new to CHROME aren'tcha?" }
];

const shakeMidDialog = "ISN'T THAT A SHAME!...";
const secondWindowVideo = "https://github.com/Git4TheHUB/Diddy-With-A-Sword/raw/refs/heads/main/Video%20Project.mp4";

let slotIndex = 0;
let popupWin = null;
let extraPopups = [];
let midDialogShown = false;

window.onload = () => setTimeout(openPopupWindow, 300);

function openPopupWindow() {
    const size = Math.min(screen.width, screen.height) * 0.7;
    popupWin = window.open("", "voidPopup",
        `width=${size},height=${size},left=${(screen.width-size)/2},top=${(screen.height-size)/2}`);

    popupWin.document.write(`
    <html><head>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>${document.querySelector('style').innerHTML}</style>
    </head>
    <body>
        <div class="popup">
            <div class="header">SIGNAL LOST</div>
            <div class="content" id="content"></div>
        </div>
    </body></html>`);
    popupWin.document.close();

    popupWin.document.body.onclick = nextSlot;
    renderSlot();
}

function typeText(el, text) {
    el.textContent="";
    let i=0;
    const t=setInterval(()=>{
        el.textContent+=text[i++];
        if(i>=text.length) clearInterval(t);
    },26);
}

function renderSlot() {
    const slot = slots[slotIndex];
    const c = popupWin.document.getElementById("content");

    let mediaHTML = slot.type==="png"
        ? `<div class="media"><img src="${slot.url}"></div>`
        : `<div class="media"><video autoplay muted loop><source src="${slot.url}"></video></div>`;

    c.innerHTML = mediaHTML + `<div class="speech" id="speech"></div>`;
    typeText(popupWin.document.getElementById("speech"), slot.text);
}

/* CHAOS POPUPS â€” USE 4TH DIALOG */
function spawnExtraPopups() {
    for(let i=0;i<3;i++){
        const w = screen.width*0.30;
        const h = screen.height*0.30;
        const x = Math.random()*(screen.width-w);
        const y = Math.random()*(screen.height-h);

        const win = window.open("", "", `width=${w},height=${h},left=${x},top=${y}`);
        win.document.write(`
        <body style="margin:0;background:black;color:white;
        font-family:'Press Start 2P';display:flex;align-items:center;justify-content:center">
        <div style="border:4px solid white;padding:20px;text-align:center">
        ${shakeMidDialog}
        </div></body>`);
        win.document.close();
        extraPopups.push(win);
    }
}

function violentShakeThenReplace() {
    let elapsed=0, spawned=false;
    const bx=popupWin.screenX, by=popupWin.screenY;

    const shaker=setInterval(()=>{
        elapsed+=0.05;
        popupWin.moveTo(bx+(Math.random()-0.5)*(12+elapsed*30),
                        by+(Math.random()-0.5)*(12+elapsed*30));

        if(!midDialogShown && elapsed>=4){
            midDialogShown=true;
            typeText(popupWin.document.getElementById("speech"), shakeMidDialog);
        }

        if(!spawned && elapsed>=5){ spawned=true; spawnExtraPopups(); }

        if(elapsed>=8){
            clearInterval(shaker);
            extraPopups.forEach(w=>w.close());
            popupWin.close();
            openGrowingVideoWindow();
        }
    },50);
}

function openGrowingVideoWindow() {
    const w=screen.width, h=screen.height;
    const win=window.open("", "", `width=${w},height=20,top=0,left=0`);
    win.document.write(`<body style="margin:0;background:black;overflow:hidden">
    <video autoplay muted loop style="width:100vw;height:100vh;object-fit:cover">
    <source src="${secondWindowVideo}">
    </video></body>`);
    win.document.close();

    let cur=20, step=h/300; // 15 sec
    const grow=setInterval(()=>{
        cur+=step;
        win.resizeTo(w,cur);
        if(cur>=h) clearInterval(grow);
    },50);
}

function nextSlot(){
    slotIndex++;
    if(slotIndex===3){ violentShakeThenReplace(); return; }
    if(slotIndex>=slots.length) slotIndex=slots.length-1;
    renderSlot();
}
</script>

</body>
</html>
